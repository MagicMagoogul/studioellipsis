<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>110 — POP3 (Post Office Protocol v3)</title>
  <style>
    :root {
      --neon: #00ff99;
      --bg: #000;
      --border: 1px solid var(--neon);
      --font: 'Courier New', Courier, monospace;
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--neon);
      font-family: var(--font);
      text-shadow: 0 0 5px var(--neon);
      line-height: 1.6;
    }

    header {
      text-align: center;
      padding: 2.25rem;
      border-bottom: var(--border);
    }

    header h1 {
      margin: 0;
      font-size: 2.4rem;
    }

    main {
      max-width: 900px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    h2 {
      border-bottom: var(--border);
      padding-bottom: 0.4rem;
    }

    code, pre {
      background: rgba(0,255,153,0.07);
      padding: 0.3rem 0.5rem;
      border-radius: 6px;
      color: var(--neon);
      display: block;
      overflow-x: auto;
    }

    details {
      margin-bottom: 1.25rem;
      border: var(--border);
      border-radius: 8px;
      padding: 1rem;
    }

    summary {
      font-weight: bold;
      cursor: pointer;
      font-size: 1.1rem;
    }

    footer {
      text-align: center;
      padding: 2rem;
      border-top: var(--border);
      margin-top: 2rem;
      font-size: 0.9rem;
    }

    a { color: var(--neon); }
    a:hover { text-shadow: 0 0 10px var(--neon); }

    .nav-link {
      color: var(--neon);
      text-decoration: none;
      font-weight: 700;
      text-shadow: 0 0 6px var(--neon);
    }
    .nav-link:hover { text-shadow: 0 0 10px var(--neon); }

    hr.soft {
      border: 0;
      height: 1px;
      background: rgba(0,255,153,0.06);
      margin: 1.5rem 0;
    }
  </style>
</head>
<body>
  <header>
    <h1>Port 110 — POP3 (Post Office Protocol v3)</h1>
    <p>A guide to enumeration and exploitation of POP3 mail services</p>
    <nav>
      <a class="nav-link" href="https://www.studioellipsis.org/Computing/Tools/Marauders_Map.html">&lt;--</a>
    </nav>
  </header>

  <main>
    <h2>0) What is POP3?</h2>
    <p>
      POP3 (Post Office Protocol version 3) is a protocol for retrieving email from a remote mail server to a client. It typically listens on TCP port 110 (plaintext) and on 995 for POP3S (TLS). POP3 downloads messages to the client and (optionally) removes them from the server. Misconfigurations, weak authentication, or exposed credentials make POP3 a target during assessments.
    </p>

    <details open>
      <summary>1) Recon Phase</summary>
      <pre>
- Detect POP3 service and banner: nmap -sV -p 110 [target]
- Check for POP3S (TLS) on port 995: nmap -sV -p 995 [target]
- Nmap NSE scripts: nmap -p 110 --script pop3-capabilities,pop3-brute [target]
- Passive recon: search for mail server hostnames in DNS (MX records) with dig/host
      </pre>
      <p>
        Record server software (Dovecot, Courier, Exchange), supported authentication methods (USER/PASS, APOP, SASL), and whether TLS is enforced.
      </p>
    </details>

    <details>
      <summary>2) Enumeration Phase</summary>
      <pre>
- Manual banner & commands: (telnet/netcat)
    nc [target] 110
    # expect: +OK <banner>

- Basic POP3 flow (manual):
    USER username
    PASS password
    STAT            # message count/size
    LIST            # list messages
    UIDL            # unique IDs
    RETR <msg#>     # retrieve message
    DELE <msg#>     # delete message
    QUIT

- Test APOP support (timestamped MD5 challenge) if offered in banner
- Use pop3-client scripts/tools (nmap pop3-* scripts, pop3scan) for automated checks
- User enumeration via VRFY is SMTP; for POP3 use username lists and observe responses/timing differences
      </pre>
      <p>
        Try connecting and issuing POP3 commands to see exact server responses. Note whether the server accepts plaintext auth or redirects to STARTTLS/POP3S.
      </p>
    </details>

    <details>
      <summary>3) Exploitation Phase</summary>
      <pre>
- Credential harvesting: if weak creds found, authenticate and download mailboxes (RETR)
- APOP: if supported and credentials can be guessed/extracted from zone files, use APOP flow
- Brute force (authorized only): hydra -L users.txt -P passwords.txt pop3://[target]
- If mailboxes contain sensitive data (password resets, API keys), pivot using discovered credentials
- Man-in-the-middle (authorized lab): intercept plaintext POP3 to capture credentials (on untrusted networks)
- Abuse mail retrieval to exfiltrate sensitive messages or to find tokens/links for lateral movement
      </pre>
      <p>
        Prioritize collecting credentials and messages that contain secrets. If server allows deletion (DELE), be careful—do not delete during assessment unless explicitly authorized.
      </p>
    </details>

    <details>
      <summary>POP3 Info — What to Look For</summary>
      <ul>
        <li>Plaintext USER/PASS authentication (no TLS) on port 110</li>
        <li>Presence of POP3S (port 995) or STARTTLS support</li>
        <li>APOP support listed in banner (timestamp + MD5 challenge)</li>
        <li>Mailboxes containing password reset emails, API keys, or onboarding messages</li>
        <li>Weak or reused credentials across services</li>
        <li>Ability to download many messages (large mailboxes may contain secrets)</li>
      </ul>
    </details>

    <h2>Tools Required</h2>
    <pre>
sudo apt install nmap netcat telnet hydra swaks openssl
# Optional / helpful:
# - fetchmail, getmail (mail retrieval)
# - pop3scan / pop3client scripts
# - Python's poplib for scripted retrieval
    </pre>

    <h2>Quick copy-paste command cheatsheet</h2>
    <pre>
# service discovery
nmap -sV -p 110,995 --script pop3-capabilities,pop3-brute <target>

# banner grab (plaintext)
nc <target> 110
# then issue: USER test / PASS test

# test POP3S (TLS)
openssl s_client -connect <target>:995 -crlf

# brute-force (authorized only)
hydra -L users.txt -P passwords.txt pop3://<target>

# automated retrieval with Python poplib (example)
python3 - <<PY
import poplib
p = poplib.POP3('<target>')
p.user('username'); p.pass_('password')
print(p.stat()); print(p.list())
p.quit()
PY
    </pre>

    <h2>Citations</h2>
    <ul>
      <li><a href="https://datatracker.ietf.org/doc/html/rfc1939" target="_blank" rel="noopener">RFC 1939 — Post Office Protocol - Version 3</a></li>
      <li><a href="https://nmap.org/nsedoc/scripts/pop3-capabilities.html" target="_blank" rel="noopener">Nmap NSE — pop3-capabilities</a></li>
      <li><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-pop3" target="_blank" rel="noopener">HackTricks — POP3 pentesting</a></li>
    </ul>

    <hr class="soft" />
    <p style="font-size:0.95rem;opacity:0.95;">
      <strong>Disclaimer:</strong> Use these techniques only on systems and mailboxes you own or are explicitly authorized to test. Capturing or accessing others' email is illegal and unethical without permission.
    </p>
  </main>

  <footer>
    &copy; 2025 Riley Owen — Studio Ellipsis Cybersecurity Writeups
  </footer>
</body>
</html>
